-- FloatingWindowLib.lua
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

local UILib = {}

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FloatingDropdownTabs"
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false
screenGui.Parent = CoreGui

function UILib:CreateTab(title: string)
	local self = {}

	-- Main frame
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0, 300, 0, 30)
	frame.Position = UDim2.new(0, 100, 0, 100)
	frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
	frame.BorderSizePixel = 0
	frame.Parent = screenGui

	-- Title (used for dragging)
	local titleLabel = Instance.new("TextLabel")
	titleLabel.Size = UDim2.new(1, -30, 1, 0)
	titleLabel.Position = UDim2.new(0, 0, 0, 0)
	titleLabel.BackgroundTransparency = 1
	titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	titleLabel.Text = title
	titleLabel.Font = Enum.Font.SourceSansBold
	titleLabel.TextSize = 20
	titleLabel.TextXAlignment = Enum.TextXAlignment.Left
	titleLabel.PaddingLeft = UDim.new(0, 6)
	titleLabel.Parent = frame

	-- Toggle button
	local toggleBtn = Instance.new("TextButton")
	toggleBtn.Size = UDim2.new(0, 30, 1, 0)
	toggleBtn.Position = UDim2.new(1, -30, 0, 0)
	toggleBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
	toggleBtn.Text = "↓"
	toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	toggleBtn.Font = Enum.Font.SourceSansBold
	toggleBtn.TextSize = 20
	toggleBtn.Parent = frame

	-- Dropdown content
	local content = Instance.new("Frame")
	content.Size = UDim2.new(1, 0, 0, 150)
	content.Position = UDim2.new(0, 0, 1, 0)
	content.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	content.Visible = false
	content.Parent = frame

	-- Dragging
	local dragging, offset
	titleLabel.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			offset = input.Position - frame.AbsolutePosition
		end
	end)
	UIS.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = false
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			frame.Position = UDim2.new(0, input.Position.X - offset.X, 0, input.Position.Y - offset.Y)
		end
	end)

	-- Toggle logic
	local open = false
	toggleBtn.MouseButton1Click:Connect(function()
		open = not open
		content.Visible = open
		toggleBtn.Text = open and "↑" or "↓"
	end)

	-- Public
	self.Content = content
	self.Frame = frame

	return self
end

return UILib
