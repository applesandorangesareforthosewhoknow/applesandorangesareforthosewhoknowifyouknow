local ui={wc=0,flags={}}
local s=setmetatable({},{
 __index=function(_,k)return game:GetService(k)end,
 __newindex=function()end})
local plr,mouse=s.Players.LocalPlayer,s.Players.LocalPlayer:GetMouse()

local function drag(o,h)
 h=h or o
 local d,sPos,sUDim
 h.InputBegan:Connect(function(i)
  if i.UserInputType==Enum.UserInputType.MouseButton1 then
   d=true;sPos,sUDim=i.Position,o.Position
   i.Changed:Connect(function()
    if i.UserInputState==Enum.UserInputState.End then d=false end
   end)
  end
 end)
 o.InputChanged:Connect(function(i)
  if i.UserInputType==Enum.UserInputType.MouseMovement then
   s.UserInputService.InputChanged:Connect(function(m)
    if m==i and d then
     local delta=m.Position-sPos
     o.Position=UDim2.new(sUDim.X.Scale,sUDim.X.Offset+delta.X,sUDim.Y.Scale,sUDim.Y.Offset+delta.Y)
    end
   end)
  end
 end)
end

local function clickFX(b)
 task.spawn(function()
  if not b.ClipsDescendants then b.ClipsDescendants=true end
  local img=Instance.new("ImageLabel")
  img.Name="Ripple"
  img.Parent=b
  img.BackgroundTransparency=1
  img.Image="rbxassetid://2708891598"
  img.ImageTransparency=0.8
  img.ImageColor3=Color3.fromRGB(131,132,255)
  img.Size=UDim2.new(0,0,0,0)
  img.Position=UDim2.new((mouse.X-b.AbsolutePosition.X)/b.AbsoluteSize.X,0,(mouse.Y-b.AbsolutePosition.Y)/b.AbsoluteSize.Y,0)
  s.TweenService:Create(img,TweenInfo.new(1),{Size=UDim2.new(12,0,12,0),Position=UDim2.new(-5.5,0,-5.5,0)}):Play()
  task.wait(.25)
  s.TweenService:Create(img,TweenInfo.new(.5),{ImageTransparency=1}):Play()
  repeat task.wait() until img.ImageTransparency==1
  img:Destroy()
 end)
end

local gui=Instance.new("ScreenGui")
gui.Name=s.HttpService:GenerateGUID(false)
gui.Parent=s.RunService:IsStudio() and plr:WaitForChild("PlayerGui") or s.CoreGui
s.UserInputService.InputBegan:Connect(function(i,g)if i.KeyCode==Enum.KeyCode.LeftShift and not g then gui.Enabled=not gui.Enabled end end)

function ui:Window(tit)
 self.wc+=1
 local y=Instance.new("Frame")
 y.Name="Top"
 y.Parent=gui
 y.BackgroundColor3=Color3.fromRGB(43,43,43)
 y.Size=UDim2.new(0,212,0,36)
 y.Position=UDim2.new(0,25,0,-30+42*self.wc)
 drag(y)
 local line=Instance.new("Frame")
 line.Name="WindowLine"
 line.Parent=y
 line.BackgroundColor3=Color3.fromRGB(30,30,30)
 line.BorderSizePixel=0
 line.Position=UDim2.new(0,0,0,34)
 line.Size=UDim2.new(0,212,0,2)
 local header=Instance.new("TextLabel")
 header.Parent=y
 header.BackgroundTransparency=1
 header.Size=UDim2.new(0,54,0,34)
 header.Font=Enum.Font.GothamSemibold
 header.Text="   "..tostring(tit)
 header.TextColor3=Color3.new(1,1,1)
 header.TextSize=14
 header.TextXAlignment=Enum.TextXAlignment.Left
 local toggle=Instance.new("TextButton")
 toggle.Name="WindowToggle"
 toggle.Parent=y
 toggle.BackgroundTransparency=1
 toggle.Position=UDim2.new(0.835,0,0,0)
 toggle.Size=UDim2.new(0,34,0,34)
 local toggleImg=Instance.new("ImageLabel")
 toggleImg.Name="WindowToggleImg"
 toggleImg.Parent=toggle
 toggleImg.AnchorPoint=Vector2.new(0.5,0.5)
 toggleImg.Position=UDim2.new(0.5,0,0.5,0)
 toggleImg.Size=UDim2.new(0,18,0,18)
 toggleImg.BackgroundTransparency=1
 toggleImg.Image="rbxassetid://3926305904"
 toggleImg.ImageRectOffset=Vector2.new(524,764)
 toggleImg.ImageRectSize=Vector2.new(36,36)
 toggleImg.Rotation=180
 local bottom=Instance.new("Frame")
 bottom.Name="Bottom"
 bottom.Parent=y
 bottom.BackgroundColor3=Color3.fromRGB(38,38,38)
 bottom.BorderSizePixel=0
 bottom.ClipsDescendants=true
 bottom.Position=UDim2.new(0,0,1,0)
 bottom.Size=UDim2.new(0,212,0,0)
 local layout=Instance.new("UIListLayout")
 layout.Name="BottomLayout"
 layout.Parent=bottom
 layout.HorizontalAlignment=Enum.HorizontalAlignment.Center
 layout.SortOrder=Enum.SortOrder.LayoutOrder
 layout.Padding=UDim.new(0,4)
 local opened,busy=false,false
 local function toggleSection()
  if busy then return end
  opened,busy=not opened,true
  s.TweenService:Create(bottom,TweenInfo.new(.25,Enum.EasingStyle.Sine),{Size=UDim2.new(0,212,0,opened and layout.AbsoluteContentSize.Y+4 or 0)}):Play()
  s.TweenService:Create(toggleImg,TweenInfo.new(.25,Enum.EasingStyle.Sine),{Rotation=opened and 0 or 180}):Play()
  task.wait(.25)
  busy=false
 end
 layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
  if not busy and opened then bottom.Size=UDim2.new(0,212,0,layout.AbsoluteContentSize.Y+4) end
 end)
 toggle.MouseButton1Click:Connect(toggleSection)
 local lib={}
 function lib:Label(txt)
  local l=Instance.new("TextButton")
  l.Parent=bottom
  l.BackgroundColor3=Color3.fromRGB(43,43,43)
  l.Size=UDim2.new(0,203,0,26)
  l.AutoButtonColor=false
  l.Font=Enum.Font.GothamSemibold
  l.Text=tostring(txt)
  l.TextColor3=Color3.new(1,1,1)
  l.TextSize=14
  return l
 end
 function lib:Button(txt,cb)
  local f=Instance.new("Frame")
  local b=Instance.new("TextButton")
  f.Name="ButtonObj"
  f.Parent=bottom
  f.BackgroundColor3=Color3.fromRGB(43,43,43)
  f.Size=UDim2.new(0,203,0,36)
  b.Name="Button"
  b.Parent=f
  b.BackgroundTransparency=1
  b.Size=UDim2.new(1,0,1,0)
  b.Font=Enum.Font.Gotham
  b.Text="  "..tostring(txt)
  b.TextColor3=Color3.new(1,1,1)
  b.TextSize=14
  b.TextXAlignment=Enum.TextXAlignment.Left
  b.MouseEnter:Connect(function() b.BackgroundTransparency=0.75 end)
  b.MouseLeave:Connect(function() b.BackgroundTransparency=1 end)
  b.MouseButton1Click:Connect(function() clickFX(b) cb() end)
  return b
 end
 function lib:Toggle(txt,id,def,cb,flags)
  flags=flags or ui.flags
  id=id or s.HttpService:GenerateGUID(false)
  def=def or false
  flags[id]=def
  local f=Instance.new("Frame")
  local btn=Instance.new("TextButton")
  local stat=Instance.new("Frame")
  local cor=Instance.new("UICorner")
  f.Name="ToggleObj"
  f.Parent=bottom
  f.BackgroundColor3=Color3.fromRGB(43,43,43)
  f.Size=UDim2.new(0,203,0,36)
  btn.Name="ToggleText"
  btn.Parent=f
  btn.BackgroundTransparency=1
  btn.Size=UDim2.new(1,0,1,0)
  btn.Font=Enum.Font.Gotham
  btn.Text="  "..tostring(txt)
  btn.TextColor3=Color3.new(1,1,1)
  btn.TextSize=14
  btn.TextXAlignment=Enum.TextXAlignment.Left
  stat.Name="ToggleStatus"
  stat.Parent=f
  stat.AnchorPoint=Vector2.new(0,0.5)
  stat.BackgroundColor3=def and Color3.fromRGB(14,255,110) or Color3.fromRGB(255,44,44)
  stat.BorderSizePixel=0
  stat.Position=UDim2.new(0.847,0,0.5,0)
  stat.Size=UDim2.new(0,24,0,24)
  cor.Parent=stat
  btn.MouseEnter:Connect(function() f.BackgroundColor3=Color3.fromRGB(55,55,55) end)
  btn.MouseLeave:Connect(function() f.BackgroundColor3=Color3.fromRGB(43,43,43) end)
  btn.MouseButton1Click:Connect(function()
   flags[id]=not flags[id]
   clickFX(btn)
   s.TweenService:Create(stat,TweenInfo.new(.25,Enum.EasingStyle.Sine),{BackgroundColor3=flags[id] and Color3.fromRGB(14,255,110) or Color3.fromRGB(255,44,44)}):Play()
   cb(flags[id])
  end)
  if def then cb(def) end
  return f
 end
 function lib:Slider(txt,id,min,max,cb,def,flags)
  min=min or 0
  max=max or 100
  flags=flags or ui.flags
  id=id or s.HttpService:GenerateGUID(false)
  def=def or min
  flags[id]=def
  local f=Instance.new("Frame")
  local b=Instance.new("TextButton")
  local back=Instance.new("Frame")
  local corBack=Instance.new("UICorner")
  local bar=Instance.new("Frame")
  local corBar=Instance.new("UICorner")
  local val=Instance.new("TextLabel")
  f.Name="SliderObj"
  f.Parent=bottom
  f.BackgroundColor3=Color3.fromRGB(43,43,43)
  f.Size=UDim2.new(0,203,0,36)
  b.Name="SliderText"
  b.Parent=f
  b.BackgroundTransparency=1
  b.Size=UDim2.new(1,0,1,0)
  b.Font=Enum.Font.Gotham
  b.Text="  "..tostring(txt)
  b.TextColor3=Color3.new(1,1,1)
  b.TextSize=14
  b.TextXAlignment=Enum.TextXAlignment.Left
  back.Name="SliderBack"
  back.Parent=f
  back.BackgroundColor3=Color3.fromRGB(38,38,38)
  back.Size=UDim2.new(0,80,0,7)
  back.Position=UDim2.new(0.57,0,0.68,0)
  corBack.Parent=back
  bar.Name="SliderPart"
  bar.Parent=back
  bar.BackgroundColor3=Color3.fromRGB(131,133,255)
  bar.Size=UDim2.new((def-min)/(max-min),0,1,0)
  corBar.Parent=bar
  val.Name="SliderValue"
  val.Parent=f
  val.BackgroundTransparency=1
  val.Position=UDim2.new(0.57,0,0.17,0)
  val.Size=UDim2.new(0,80,0,16)
  val.Font=Enum.Font.Code
  val.Text=tostring(def)
  val.TextColor3=Color3.new(1,1,1)
  val.TextSize=14
  local dragging=false
  local function update(p)
   local scale=math.clamp((p.Position.X-back.AbsolutePosition.X)/back.AbsoluteSize.X,0,1)
   bar:TweenSize(UDim2.new(scale,0,1,0),Enum.EasingDirection.InOut,Enum.EasingStyle.Linear,0.05,true)
   local v=math.floor(scale*(max-min)+min)
   val.Text=tostring(v)
   flags[id]=v
   cb(v)
  end
  b.InputBegan:Connect(function(p)
   if p.UserInputType==Enum.UserInputType.MouseButton1 then
    clickFX(b)
    update(p)
    dragging=true
   end
  end)
  b.InputEnded:Connect(function(p)
   if p.UserInputType==Enum.UserInputType.MouseButton1 then
    dragging=false
   end
  end)
  s.UserInputService.InputChanged:Connect(function(p)
   if dragging and p.UserInputType==Enum.UserInputType.MouseMovement then update(p) end
  end)
  return f
 end
 return lib
end

return ui
