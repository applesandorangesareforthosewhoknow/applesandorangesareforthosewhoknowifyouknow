local ui={count=0,flags={}}
local s=setmetatable({},{
	__index=function(_,k)return game:GetService(k)end,
	__newindex=function()end
})
local plr=s.Players.LocalPlayer
local mouse=plr:GetMouse()
local usr=s.UserInputService
local ts=s.TweenService
local function drag(f,d)
	d=d or f
	local drag,di,ds,sp
	d.InputBegan:Connect(function(i)
		if i.UserInputType==Enum.UserInputType.MouseButton1 then
			drag=true
			ds=i.Position
			sp=f.Position
			i.Changed:Connect(function()
				if i.UserInputState==Enum.UserInputState.End then drag=false end
			end)
		end
	end)
	d.InputChanged:Connect(function(i)
		if i.UserInputType==Enum.UserInputType.MouseMovement then di=i end
	end)
	usr.InputChanged:Connect(function(i)
		if i==di and drag then
			local delta=i.Position - ds
			f.Position=UDim2.new(sp.X.Scale,sp.X.Offset+delta.X,sp.Y.Scale,sp.Y.Offset+delta.Y)
		end
	end)
end
local function clickEff(p)
	coroutine.wrap(function()
		if not p.ClipsDescendants then p.ClipsDescendants=true end
		local r=Instance.new("ImageLabel",p)
		r.Name="Ripple"
		r.BackgroundTransparency=1
		r.ZIndex=8
		r.Image="rbxassetid://2708891598"
		r.ImageTransparency=0.8
		r.ScaleType=Enum.ScaleType.Fit
		r.ImageColor3=Color3.fromRGB(131,132,255)
		r.Position=UDim2.new((mouse.X-r.AbsolutePosition.X)/p.AbsoluteSize.X,0,(mouse.Y-r.AbsolutePosition.Y)/p.AbsoluteSize.Y,0)
		ts:Create(r,TweenInfo.new(1),{Position=UDim2.new(-5.5,0,-5.5,0),Size=UDim2.new(12,0,12,0)}):Play()
		wait(.25)
		ts:Create(r,TweenInfo.new(.5),{ImageTransparency=1}):Play()
		repeat wait() until r.ImageTransparency==1
		r:Destroy()
	end)()
end

local sg=Instance.new("ScreenGui")
sg.Name=s.HttpService:GenerateGUID()
sg.Parent=s.RunService:IsStudio() and plr:WaitForChild("PlayerGui") or s.CoreGui
usr.InputBegan:Connect(function(i,g)
	if i.KeyCode==Enum.KeyCode.LeftShift and not g then
		sg.Enabled=not sg.Enabled
	end
end)

function ui:Tab(tit)
	self.count=self.count+1
	local y=Instance.new("Frame",sg)
	y.Name="Top"
	y.BackgroundColor3=Color3.fromRGB(43,43,43)
	y.BorderSizePixel=0
	y.Position=UDim2.new(0,25,0,10+(42*(self.count-1)))
	y.Size=UDim2.new(0,212,0,36)
	drag(y)
	local line=Instance.new("Frame",y)
	line.Name="WindowLine"
	line.BackgroundColor3=Color3.fromRGB(30,30,30)
	line.BorderSizePixel=0
	line.Position=UDim2.new(0,0,0,34)
	line.Size=UDim2.new(0,212,0,2)
	local header=Instance.new("TextLabel",y)
	header.Name="Header"
	header.BackgroundTransparency=1
	header.Size=UDim2.new(0,54,0,34)
	header.Font=Enum.Font.GothamSemibold
	header.Text="   "..tostring(tit or "")
	header.TextColor3=Color3.new(1,1,1)
	header.TextSize=14
	header.TextXAlignment=Enum.TextXAlignment.Left
	local toggle=Instance.new("TextButton",y)
	toggle.Name="WindowToggle"
	toggle.BackgroundTransparency=1
	toggle.Position=UDim2.new(0.835,0,0,0)
	toggle.Size=UDim2.new(0,34,0,34)
	local toggleImg=Instance.new("ImageLabel",toggle)
	toggleImg.AnchorPoint=Vector2.new(0.5,0.5)
	toggleImg.BackgroundTransparency=1
	toggleImg.Position=UDim2.new(0.5,0,0.5,0)
	toggleImg.Size=UDim2.new(0,18,0,18)
	toggleImg.Image="rbxassetid://3926305904"
	toggleImg.ImageRectOffset=Vector2.new(524,764)
	toggleImg.ImageRectSize=Vector2.new(36,36)
	toggleImg.Rotation=180
	local bottom=Instance.new("Frame",y)
	bottom.Name="Bottom"
	bottom.BackgroundColor3=Color3.fromRGB(38,38,38)
	bottom.BorderSizePixel=0
	bottom.ClipsDescendants=true
	bottom.Position=UDim2.new(0,0,1,0)
	bottom.Size=UDim2.new(0,212,0,0)
	local layout=Instance.new("UIListLayout",bottom)
	layout.HorizontalAlignment=Enum.HorizontalAlignment.Center
	layout.SortOrder=Enum.SortOrder.LayoutOrder
	layout.Padding=UDim.new(0,4)
	local padding=Instance.new("Frame",bottom)
	padding.BackgroundTransparency=1
	padding.Size=UDim2.new(0,100,0,0)
	local open=false
	local busy=false
	local function toggleFunc()
		if busy then return end
		open=not open
		busy=true
		ts:Create(bottom,TweenInfo.new(.25,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{Size=UDim2.new(0,212,0,open and layout.AbsoluteContentSize.Y+4 or 0)}):Play()
		ts:Create(toggleImg,TweenInfo.new(.25,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{Rotation=open and 0 or 180}):Play()
		wait(.25)
		busy=false
	end
	local function updateSize()
		if busy or not open then return end
		bottom.Size=UDim2.new(0,212,0,layout.AbsoluteContentSize.Y+4)
	end
	layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateSize)
	toggle.MouseButton1Click:Connect(toggleFunc)
	local obj={}
	function obj:Label(txt)
		local lb=Instance.new("TextButton",bottom)
		lb.Name="Label"
		lb.BackgroundColor3=Color3.fromRGB(43,43,43)
		lb.BorderSizePixel=0
		lb.Size=UDim2.new(0,203,0,26)
		lb.AutoButtonColor=false
		lb.Font=Enum.Font.GothamSemibold
		lb.Text=tostring(txt or "")
		lb.TextColor3=Color3.new(1,1,1)
		lb.TextSize=14
		return lb
	end
	function obj:Button(txt,cb)
		local cb=cb or function()end
		local fr=Instance.new("Frame",bottom)
		fr.Name="ButtonObj"
		fr.BackgroundColor3=Color3.fromRGB(43,43,43)
		fr.BorderSizePixel=0
		fr.Size=UDim2.new(0,203,0,36)
		local btn=Instance.new("TextButton",fr)
		btn.Name="Button"
		btn.BackgroundTransparency=1
		btn.Size=UDim2.new(1,0,1,0)
		btn.Font=Enum.Font.Gotham
		btn.Text="  "..tostring(txt or "")
		btn.TextColor3=Color3.new(1,1,1)
		btn.TextSize=14
		btn.TextXAlignment=Enum.TextXAlignment.Left
		btn.MouseEnter:Connect(function()
			ts:Create(fr,TweenInfo.new(.25),{BackgroundColor3=Color3.fromRGB(55,55,55)}):Play()
		end)
		btn.MouseLeave:Connect(function()
			ts:Create(fr,TweenInfo.new(.25),{BackgroundColor3=Color3.fromRGB(43,43,43)}):Play()
		end)
		btn.MouseButton1Click:Connect(function()
			coroutine.wrap(function() clickEff(btn) end)()
			cb()
		end)
		return btn
	end
	function obj:Toggle(txt,id,state,cb,flags)
		local id=id or s.HttpService:GenerateGUID()
		local cb=cb or function()end
		local flags=flags or ui.flags
		flags[id]=state or false
		local fr=Instance.new("Frame",bottom)
		fr.Name="ToggleObj"
		fr.BackgroundColor3=Color3.fromRGB(43,43,43)
		fr.BorderSizePixel=0
		fr.Size=UDim2.new(0,203,0,36)
		local btn=Instance.new("TextButton",fr)
		btn.Name="ToggleText"
		btn.BackgroundTransparency=1
		btn.Size=UDim2.new(1,0,1,0)
		btn.Font=Enum.Font.Gotham
		btn.Text="  "..tostring(txt or "")
		btn.TextColor3=Color3.new(1,1,1)
		btn.TextSize=14
		btn.TextXAlignment=Enum.TextXAlignment.Left
		local status=Instance.new("Frame",fr)
		status.Name="ToggleStatus"
		status.AnchorPoint=Vector2.new(0,0.5)
		status.BackgroundColor3=flags[id] and Color3.fromRGB(14,255,110) or Color3.fromRGB(255,44,44)
		status.BorderSizePixel=0
		status.Position=UDim2.new(0.847,0,0.5,0)
		status.Size=UDim2.new(0,24,0,24)
		local cr=Instance.new("UICorner",status)
		cr.CornerRadius=UDim.new(0,4)
		if flags[id] then cb(true) end
		btn.MouseEnter:Connect(function()
			ts:Create(fr,TweenInfo.new(.25),{BackgroundColor3=Color3.fromRGB(55,55,55)}):Play()
		end)
		btn.MouseLeave:Connect(function()
			ts:Create(fr,TweenInfo.new(.25),{BackgroundColor3=Color3.fromRGB(43,43,43)}):Play()
		end)
		btn.MouseButton1Click:Connect(function()
			flags[id]=not flags[id]
			coroutine.wrap(function()
				ts:Create(status,TweenInfo.new(.25),{BackgroundColor3=flags[id] and Color3.fromRGB(14,255,110) or Color3.fromRGB(255,44,44)}):Play()
			end)()
			coroutine.wrap(function() clickEff(btn) end)()
			cb(flags[id])
		end)
		return btn
	end
	function obj:Slider(text,min,max,id,cb,flags)
		min=min or 0
		max=max or 100
		id=id or s.HttpService:GenerateGUID()
		cb=cb or function()end
		flags=flags or ui.flags
		flags[id]=flags[id] or min
		local dragging=false
		local fr=Instance.new("Frame",bottom)
		fr.Name="SliderObj"
		fr.BackgroundColor3=Color3.fromRGB(43,43,43)
		fr.BorderSizePixel=0
		fr.Size=UDim2.new(0,203,0,36)
		local lbl=Instance.new("TextButton",fr)
		lbl.BackgroundTransparency=1
		lbl.Size=UDim2.new(1,0,1,0)
		lbl.Font=Enum.Font.Gotham
		lbl.Text="  "..tostring(text or "")
		lbl.TextColor3=Color3.new(1,1,1)
		lbl.TextSize=14
		lbl.TextXAlignment=Enum.TextXAlignment.Left
		local back=Instance.new("Frame",fr)
		back.BackgroundColor3=Color3.fromRGB(38,38,38)
		back.Position=UDim2.new(0.57,0,0.68,0)
		back.Size=UDim2.new(0,80,0,7)
		local fill=Instance.new("Frame",back)
		fill.BackgroundColor3=Color3.fromRGB(131,133,255)
		fill.Size=UDim2.new((flags[id]-min)/(max-min),0,1,0)
		local function update(input)
			local relX=math.clamp(input.Position.X-back.AbsolutePosition.X,0,back.AbsoluteSize.X)
			local scale=relX/back.AbsoluteSize.X
			fill.Size=UDim2.new(scale,0,1,0)
			local val=math.floor(scale*(max-min)+min)
			flags[id]=val
			lbl.Text="  "..text.." "..val
			cb(val)
		end
		lbl.InputBegan:Connect(function(i)
			if i.UserInputType==Enum.UserInputType.MouseButton1 then
				dragging=true
				update(i)
			end
		end)
		lbl.InputEnded:Connect(function(i)
			if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=false end
		end)
		usr.InputChanged:Connect(function(i)
			if dragging and i.UserInputType==Enum.UserInputType.MouseMovement then update(i) end
		end)
		return fr
	end
	return obj
end
return ui
